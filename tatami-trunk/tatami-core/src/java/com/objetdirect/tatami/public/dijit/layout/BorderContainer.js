/*
	Copyright (c) 2004-2008, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dijit.layout.BorderContainer"]){dojo._hasResource["dijit.layout.BorderContainer"]=true;dojo.provide("dijit.layout.BorderContainer");dojo.require("dijit.layout._LayoutWidget");dojo.require("dojo.cookie");dojo.declare("dijit.layout.BorderContainer",dijit.layout._LayoutWidget,{design:"headline",gutters:true,liveSplitters:true,persist:false,baseClass:"dijitBorderContainer",_splitterClass:"dijit.layout._Splitter",postMixInProperties:function(){if(!this.gutters){this.baseClass+="NoGutter";}this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this._splitters={};this._splitterThickness={};this._regions={};dojo.forEach(this.getChildren(),function(_1){if(_1.region){this._regions[_1.region]=_1;}},this);},startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),this._setupChild,this);this.inherited(arguments);},_setupChild:function(_2){var _3=_2.region;if(_3){this.inherited(arguments);dojo.addClass(_2.domNode,this.baseClass+"Pane");var _4=this.isLeftToRight();if(_3=="leading"){_3=_4?"left":"right";}if(_3=="trailing"){_3=_4?"right":"left";}this["_"+_3]=_2.domNode;this["_"+_3+"Widget"]=_2;if((_2.splitter||this.gutters)&&!this._splitters[_3]){var _5=dojo.getObject(_2.splitter?this._splitterClass:"dijit.layout._Gutter");var _6={left:"right",right:"left",top:"bottom",bottom:"top",leading:"trailing",trailing:"leading"};var _7=new _5({container:this,child:_2,region:_3,oppNode:this._regions[_6[_2.region]],live:this.liveSplitters});_7.isSplitter=true;this._splitters[_3]=_7.domNode;dojo.place(this._splitters[_3],_2.domNode,"after");_7.startup();}_2.region=_3;}},_computeSplitterThickness:function(_8){this._splitterThickness[_8]=this._splitterThickness[_8]||dojo.marginBox(this._splitters[_8])[(/top|bottom/.test(_8)?"h":"w")];},layout:function(){for(var _9 in this._splitters){this._computeSplitterThickness(_9);}this._layoutChildren();},addChild:function(_a,_b){this.inherited(arguments);if(this._started){this._layoutChildren();}},removeChild:function(_c){var _d=_c.region;var _e=this._splitters[_d];if(_e){dijit.byNode(_e).destroy();delete this._regions[_d];delete this._splitters[_d];delete this._splitterThickness[_d];}this.inherited(arguments);delete this["_"+_d];delete this["_"+_d+"Widget"];if(this._started){this._layoutChildren(_c.region);}dojo.removeClass(_c.domNode,this.baseClass+"Pane");},getChildren:function(){return dojo.filter(this.inherited(arguments),function(_f){return !_f.isSplitter;});},getSplitter:function(_10){var _11=this._splitters[_10];return _11?dijit.byNode(_11):null;},resize:function(_12,_13){if(!this.cs||!this.pe){var _14=this.domNode;this.cs=dojo.getComputedStyle(_14);this.pe=dojo._getPadExtents(_14,this.cs);this.pe.r=dojo._toPixelValue(_14,this.cs.paddingRight);this.pe.b=dojo._toPixelValue(_14,this.cs.paddingBottom);dojo.style(_14,"padding","0px");}this.inherited(arguments);},_layoutChildren:function(_15){var _16=(this.design=="sidebar");var _17=0,_18=0,_19=0,_1a=0;var _1b={},_1c={},_1d={},_1e={},_1f=(this._center&&this._center.style)||{};var _20=/left|right/.test(_15);var _21=!_15||(!_20&&!_16);var _22=!_15||(_20&&_16);if(this._top){_1b=_22&&this._top.style;_17=dojo.marginBox(this._top).h;}if(this._left){_1c=_21&&this._left.style;_19=dojo.marginBox(this._left).w;}if(this._right){_1d=_21&&this._right.style;_1a=dojo.marginBox(this._right).w;}if(this._bottom){_1e=_22&&this._bottom.style;_18=dojo.marginBox(this._bottom).h;}var _23=this._splitters;var _24=_23.top,_25=_23.bottom,_26=_23.left,_27=_23.right;var _28=this._splitterThickness;var _29=_28.top||0,_2a=_28.left||0,_2b=_28.right||0,_2c=_28.bottom||0;if(_2a>50||_2b>50){setTimeout(dojo.hitch(this,function(){this._splitterThickness={};for(var _2d in this._splitters){this._computeSplitterThickness(_2d);}this._layoutChildren();}),50);return false;}var pe=this.pe;var _2f={left:(_16?_19+_2a:0)+pe.l+"px",right:(_16?_1a+_2b:0)+pe.r+"px"};if(_24){dojo.mixin(_24.style,_2f);_24.style.top=_17+pe.t+"px";}if(_25){dojo.mixin(_25.style,_2f);_25.style.bottom=_18+pe.b+"px";}_2f={top:(_16?0:_17+_29)+pe.t+"px",bottom:(_16?0:_18+_2c)+pe.b+"px"};if(_26){dojo.mixin(_26.style,_2f);_26.style.left=_19+pe.l+"px";}if(_27){dojo.mixin(_27.style,_2f);_27.style.right=_1a+pe.r+"px";}dojo.mixin(_1f,{top:pe.t+_17+_29+"px",left:pe.l+_19+_2a+"px",right:pe.r+_1a+_2b+"px",bottom:pe.b+_18+_2c+"px"});var _30={top:_16?pe.t+"px":_1f.top,bottom:_16?pe.b+"px":_1f.bottom};dojo.mixin(_1c,_30);dojo.mixin(_1d,_30);_1c.left=pe.l+"px";_1d.right=pe.r+"px";_1b.top=pe.t+"px";_1e.bottom=pe.b+"px";if(_16){_1b.left=_1e.left=_19+_2a+pe.l+"px";_1b.right=_1e.right=_1a+_2b+pe.r+"px";}else{_1b.left=_1e.left=pe.l+"px";_1b.right=_1e.right=pe.r+"px";}var _31=this._borderBox.h-pe.t-pe.b,_32=_31-(_17+_29+_18+_2c),_33=_16?_31:_32;var _34=this._borderBox.w-pe.l-pe.r,_35=_34-(_19+_2a+_1a+_2b),_36=_16?_35:_34;var dim={top:{w:_36,h:_17},bottom:{w:_36,h:_18},left:{w:_19,h:_33},right:{w:_1a,h:_33},center:{h:_32,w:_35}};var _38=dojo.isIE<8||dojo.some(this.getChildren(),function(_39){return _39.domNode.tagName=="TEXTAREA"||_39.domNode.tagName=="INPUT";});if(_38){var _3a=function(_3b,_3c,_3d){if(_3b){(_3b.resize?_3b.resize(_3c,_3d):dojo.marginBox(_3b.domNode,_3c));}};if(_26){_26.style.height=_33;}if(_27){_27.style.height=_33;}_3a(this._leftWidget,{h:_33},dim.left);_3a(this._rightWidget,{h:_33},dim.right);if(_24){_24.style.width=_36;}if(_25){_25.style.width=_36;}_3a(this._topWidget,{w:_36},dim.top);_3a(this._bottomWidget,{w:_36},dim.bottom);_3a(this._centerWidget,dim.center);}else{var _3e={};if(_15){_3e[_15]=_3e.center=true;if(/top|bottom/.test(_15)&&this.design!="sidebar"){_3e.left=_3e.right=true;}else{if(/left|right/.test(_15)&&this.design=="sidebar"){_3e.top=_3e.bottom=true;}}}dojo.forEach(this.getChildren(),function(_3f){if(_3f.resize&&(!_15||_3f.region in _3e)){_3f.resize(null,dim[_3f.region]);}},this);}},destroy:function(){for(region in this._splitters){var _40=this._splitters[region];dijit.byNode(_40).destroy();dojo._destroyElement(_40);}delete this._regions;delete this._splitters;delete this._splitterThickness;this.inherited(arguments);}});dojo.extend(dijit._Widget,{region:"",splitter:false,minSize:0,maxSize:Infinity});dojo.require("dijit._Templated");dojo.declare("dijit.layout._Splitter",[dijit._Widget,dijit._Templated],{live:true,templateString:"<div class=\"dijitSplitter\" dojoAttachEvent=\"onkeypress:_onKeyPress,onmousedown:_startDrag\" tabIndex=\"0\" waiRole=\"separator\"><div class=\"dijitSplitterThumb\"></div></div>",postCreate:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);dojo.addClass(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));this._factor=/top|left/.test(this.region)?1:-1;this._minSize=this.child.minSize;this.child.domNode._recalc=true;this.connect(this.container,"resize",function(){this.child.domNode._recalc=true;});this._cookieName=this.container.id+"_"+this.region;if(this.container.persist){var _41=dojo.cookie(this._cookieName);if(_41){this.child.domNode.style[this.horizontal?"height":"width"]=_41;}}},_computeMaxSize:function(){var dim=this.horizontal?"h":"w",_43=this.container._splitterThickness[this.region];var _44=dojo.contentBox(this.container.domNode)[dim]-(this.oppNode?dojo.marginBox(this.oppNode)[dim]:0)-20-_43*2;this._maxSize=Math.min(this.child.maxSize,_44);},_startDrag:function(e){if(this.child.domNode._recalc){this._computeMaxSize();this.child.domNode._recalc=false;}if(!this.cover){this.cover=dojo.doc.createElement("div");dojo.addClass(this.cover,"dijitSplitterCover");dojo.place(this.cover,this.child.domNode,"after");}else{this.cover.style.zIndex=1;}if(this.fake){dojo._destroyElement(this.fake);}if(!(this._resize=this.live)){(this.fake=this.domNode.cloneNode(true)).removeAttribute("id");dojo.addClass(this.domNode,"dijitSplitterShadow");dojo.place(this.fake,this.domNode,"after");}dojo.addClass(this.domNode,"dijitSplitterActive");var _46=this._factor,max=this._maxSize,min=this._minSize||20,_49=this.horizontal,_4a=_49?"pageY":"pageX",_4b=e[_4a],_4c=this.domNode.style,dim=_49?"h":"w",_4e=dojo.marginBox(this.child.domNode)[dim],_4f=this.region,_50=parseInt(this.domNode.style[_4f],10),_51=this._resize,mb={},_53=this.child.domNode,_54=dojo.hitch(this.container,this.container._layoutChildren),de=dojo.doc.body;this._handlers=(this._handlers||[]).concat([dojo.connect(de,"onmousemove",this._drag=function(e,_57){var _58=e[_4a]-_4b,_59=_46*_58+_4e,_5a=Math.max(Math.min(_59,max),min);if(_51||_57){mb[dim]=_5a;dojo.marginBox(_53,mb);_54(_4f);}_4c[_4f]=_46*_58+_50+(_5a-_59)+"px";}),dojo.connect(de,"onmouseup",this,"_stopDrag")]);dojo.stopEvent(e);},_stopDrag:function(e){try{if(this.cover){this.cover.style.zIndex=-1;}if(this.fake){dojo._destroyElement(this.fake);}dojo.removeClass(this.domNode,"dijitSplitterActive");dojo.removeClass(this.domNode,"dijitSplitterShadow");this._drag(e);this._drag(e,true);}finally{this._cleanupHandlers();if(this.oppNode){this.oppNode._recalc=true;}delete this._drag;}if(this.container.persist){dojo.cookie(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365});}},_cleanupHandlers:function(){dojo.forEach(this._handlers,dojo.disconnect);delete this._handlers;},_onKeyPress:function(e){if(this.child.domNode._recalc){this._computeMaxSize();this.child.domNode._recalc=false;}this._resize=true;var _5d=this.horizontal;var _5e=1;var dk=dojo.keys;switch(e.charOrCode){case _5d?dk.UP_ARROW:dk.LEFT_ARROW:_5e*=-1;case _5d?dk.DOWN_ARROW:dk.RIGHT_ARROW:break;default:return;}var _60=dojo.marginBox(this.child.domNode)[_5d?"h":"w"]+this._factor*_5e;var mb={};mb[this.horizontal?"h":"w"]=Math.max(Math.min(_60,this._maxSize),this._minSize);dojo.marginBox(this.child.domNode,mb);if(this.oppNode){this.oppNode._recalc=true;}this.container._layoutChildren(this.region);dojo.stopEvent(e);},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.fake;this.inherited(arguments);}});dojo.declare("dijit.layout._Gutter",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitGutter\" waiRole=\"presentation\"></div>",postCreate:function(){this.horizontal=/top|bottom/.test(this.region);dojo.addClass(this.domNode,"dijitGutter"+(this.horizontal?"H":"V"));}});}