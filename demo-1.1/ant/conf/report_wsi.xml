<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- CVS History
	  $Log: report_wsi.xml,v $
	  Revision 1.1  2007/12/18 13:13:27  beal6226
	  Version G3R2C0
	
	  Revision 1.1  2005/05/26 12:14:34  beal6226
	  Ajout de tâches de reporting : WSI
	
-->
<!DOCTYPE project [
		<!ENTITY setenv SYSTEM "../conf/setenv.xml">	
	]>
<project name="report_wsi" default="init" basedir="../..">

	<!-- Chargement des propriétés -->
	&setenv;
    <property file="${ant.modules.dir}/${module.type}.${module.name}.properties" />

	<!-- Il faut mettre le chemin du wsdl en absolu pour que wsi trouve les xsd associés -->
	<property name="wsdl.output"
	          value="${basedir}/${j2ee.dir}/${module.type}/${module.name}${wsdl.output.name}" />


	<target name="report" depends="init,define_wsi">
		<echo message="Vérification WSI du fichier wsdl ${wsdl.output}" />
		<!-- le répertoire de travail est ant/conf/wsi car le programme y cherche ses dépendances 
		     du coup, les autres répertoires (wsdl et tmp) doivent être en absolu -->
		<mkdir dir="${tmp.dir}/${module.type}/${module.name}" />
		<java classname="com.francetelecom.clara.wsi.WsiWrapper"
		      classpathref="wsi.classpath"
		      dir="${ant.conf.dir}/wsi"
			  fork="true"
			  failonerror="true">
			<arg line="-wsdlURI ${wsdl.output} -config analyzerConfig.xml -reportDir ${basedir}/${tmp.dir}/${module.type}/${module.name} -replace true" />
		</java>

		<copy file="${ant.conf.dir}/wsi/common/profiles/SSBP10_BP11_TAD.html" 
			  todir="${dist.dir}/reports/wsi" />

		<xslt basedir="${tmp.dir}/${module.type}/${module.name}"
			  includes="report*.xml"
		      destdir="${dist.dir}/reports/wsi"
		      style="${ant.conf.dir}/wsi/common/xsl/report.xsl">
		</xslt>
		

		<echo message="========== Rapport wsi terminé, consulter ${dist.dir}/reports/wsi ==========" />

	</target>

	<!-- TARGET internet init -->
	<target name="init">
		<!-- Création des répertoires nécessaires au fonctionnement du rapport -->
		<mkdir dir="${tmp.dir}" />
		<mkdir dir="${dist.dir}/reports/wsi" />
	</target>

</project>